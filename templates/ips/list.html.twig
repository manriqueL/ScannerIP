{% extends 'base/index.html.twig' %}

{% block title %}Ip Scann{% endblock %}

{% block rowMain %}
    <div class="d-sm-flex align-items-center justify-content-between">
        <h1 class="h3 mb-0 text-dark"><b>Lista de IPs</b></h1>
        
    </div>
<div class="d-flex justify-content-end mb-3">
    <button id="update-button" class="btn btn-sm btn-primary shadow-sm me-2">
        <i class="fas fa-sync-alt fa-rotate-right"></i> &nbsp; Actualizar
    </button>
</div>
<div class="table-responsive" style="text-align: center">
    <table class="table table-striped" id="ips-table">
        <thead>
            <tr>
                <th>Dirección IP</th>
                <th>Estado</th>
                <th>Última conexión</th>
                <th>Tiempo en Inactividad</th>
            </tr>
        </thead>
        <tbody>
            {% include 'ips/list_table.html.twig' %}
        

        </tbody>

    </table>
</div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>


    $(document).ready(function() {


    // Manejar el clic en el botón de actualización
    $('#update-button').click(function() {
        $.ajax({
            type: 'GET',
            url: "{{ path('actualizar_ips') }}",
            dataType: 'html', // Cambiamos esto a 'html' para recibir una vista Twig
            success: function(response) {
                // Reemplazamos la tabla completa con la nueva tabla generada
                $('#ips-table tbody').html(response);
            },
            error: function(error) {
                console.error('Error al obtener los datos de IPs actualizados: ' + error.responseText);
            }
        });
    });
    });
    
</script>
{% endblock %}
